/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var R=Object.create;var C=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var E=i=>C(i,"__esModule",{value:!0});var k=(i,e)=>{E(i);for(var s in e)C(i,s,{get:e[s],enumerable:!0})},A=(i,e,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of H(e))!P.call(i,t)&&t!=="default"&&C(i,t,{get:()=>e[t],enumerable:!(s=O(e,t))||s.enumerable});return i},T=i=>A(E(C(i!=null?R(D(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var w=(i,e,s)=>new Promise((t,l)=>{var n=a=>{try{o(s.next(a))}catch(d){l(d)}},u=a=>{try{o(s.throw(a))}catch(d){l(d)}},o=a=>a.done?t(a.value):Promise.resolve(a.value).then(n,u);o((s=s.apply(i,e)).next())});k(exports,{default:()=>b});function f(i,e){let s=Object.keys(e).map(t=>q(i,t,e[t]));return s.length===1?s[0]:function(){s.forEach(t=>t())}}function q(i,e,s){let t=i[e],l=i.hasOwnProperty(e),n=s(t);return t&&Object.setPrototypeOf(n,t),Object.setPrototypeOf(u,n),i[e]=u,o;function u(...a){return n===t&&i[e]===u&&o(),n.apply(this,a)}function o(){i[e]===u&&(l?i[e]=t:delete i[e]),n!==t&&(n=t,Object.setPrototypeOf(u,t||Function))}}var g=T(require("obsidian"));var c=T(require("obsidian"));var p=i18next.t.bind(i18next);var v={defaultCollapse:!1,defaultShowContext:!1,defaultHideTitle:!1,defaultHideResults:!1,defaultSortOrder:"alphabetical"},S={alphabetical:p("plugins.file-explorer.label-sort-a-to-z"),alphabeticalReverse:p("plugins.file-explorer.label-sort-z-to-a"),byModifiedTime:p("plugins.file-explorer.label-sort-new-to-old"),byModifiedTimeReverse:p("plugins.file-explorer.label-sort-old-to-new"),byCreatedTime:p("plugins.file-explorer.label-sort-created-new-to-old"),byCreatedTimeReverse:p("plugins.file-explorer.label-sort-created-old-to-new")},x=class extends c.PluginSettingTab{constructor(e,s){super(e,s);this.plugin=s}hide(){}display(){let{containerEl:e}=this;e.empty(),new c.Setting(e).setName("Collapse query results by default").addToggle(s=>s.setValue(this.plugin.settings.defaultCollapse).onChange(t=>{this.plugin.settings.defaultCollapse=t,this.plugin.saveSettings()})),new c.Setting(e).setName("Show additional query result context by default").addToggle(s=>s.setValue(this.plugin.settings.defaultShowContext).onChange(t=>{this.plugin.settings.defaultShowContext=t,this.plugin.saveSettings()})),new c.Setting(e).setName("Hide query title by default").addToggle(s=>s.setValue(this.plugin.settings.defaultHideTitle).onChange(t=>{this.plugin.settings.defaultHideTitle=t,this.plugin.saveSettings()})),new c.Setting(e).setName("Hide query results by default").addToggle(s=>s.setValue(this.plugin.settings.defaultHideResults).onChange(t=>{this.plugin.settings.defaultHideResults=t,this.plugin.saveSettings()})),new c.Setting(e).setName("Default query result sort order").addDropdown(s=>{s.addOptions(S),s.setValue(this.plugin.settings.defaultSortOrder),s.onChange(t=>w(this,null,function*(){this.plugin.settings.defaultSortOrder=t,yield this.plugin.saveSettings()}))})}};var b=class extends g.Plugin{onload(){return w(this,null,function*(){yield this.loadSettings();let e=this;this.registerSettingsTab(),this.register(f(this.app.viewRegistry.constructor.prototype,{registerView(t){return function(l,n,...u){return e.app.workspace.trigger("view-registered",l,n),t.call(this,l,n,...u)}}}));let s;if(this.app.workspace.layoutReady)this.getSearchExport();else{let t=this.app.workspace.on("view-registered",(l,n)=>{if(l!=="search")return;this.app.workspace.offref(t);let u=new g.WorkspaceLeaf(e.app),o=n(u),a=f(g.Modal.prototype,{open(d){return function(...h){e.SearchResultsExport=this.constructor}}});o.onCopyResultsClick(new MouseEvent(null)),a(),e.SearchHeaderDom=o.headerDom.constructor})}this.register(s=f(g.Component.prototype,{addChild(t){return function(l,...n){try{if(l.hasOwnProperty("searchQuery")&&l.hasOwnProperty("sourcePath")){let o=l.constructor,a=l.dom.constructor;e.patchSearchView(o,a),s()}}catch(o){console.log(o)}return t.call(this,l,...n)}}}))})}loadSettings(){return w(this,null,function*(){this.settings=Object.assign({},v,yield this.loadData())})}saveSettings(){return w(this,null,function*(){yield this.saveData(this.settings)})}registerSettingsTab(){this.settingsTab=new x(this.app,this),this.addSettingTab(this.settingsTab)}getSearchHeader(){var s,t,l;let e=(l=(t=(s=this.app.workspace.getLeavesOfType("search"))==null?void 0:s.first())==null?void 0:t.view)==null?void 0:l.headerDom;return e==null?void 0:e.constructor}getSearchExport(){var l,n;let e=this,s=(n=(l=this.app.workspace.getLeavesOfType("search"))==null?void 0:l.first())==null?void 0:n.view,t=f(g.Modal.prototype,{open(u){return function(...o){e.SearchResultsExport=this.constructor}}});s==null||s.onCopyResultsClick(new MouseEvent(null)),t()}onunload(){}patchSearchView(e,s){let t=this;this.register(f(e.prototype,{onload(l){return function(...n){try{let o=this.containerEl.parentElement.querySelector(".internal-query-header"),a=this.query.matchAll(/^(?<key>collapsed|context|hideTitle|hideResults|sort|title):\s*(?<value>.+?)$/gm),d={};for(let h of a){let m=h.groups.value.toLowerCase();(m==="true"||m==="false")&&(h.groups.value=m==="true"),d[h.groups.key]=h.groups.value}console.log(d),this.query=this.query.replace(/^((collapsed|context|hideTitle|hideResults|sort|title):.+?)$/gm,"").trim(),o.setText(d.title||this.query),this.dom.settings=d}catch(o){}return l.call(this,...n)}}})),this.register(f(s.prototype,{startLoader(l){return function(...n){var o;try{if(!this.patched&&((o=this.el)==null?void 0:o.closest(".internal-query"))){let a=this.el.parentElement.querySelector(".internal-query-header");this.patched=!0,this.setExtraContext=function(r){this.extraContext=r,this.extraContextButtonEl.toggleClass("is-active",r),this.children.forEach(y=>{y.setExtraContext(r)}),this.infinityScroll.invalidateAll()},this.setTitleDisplay=function(r){this.showTitle=r,this.showTitleButtonEl.toggleClass("is-active",r),a.toggleClass("is-hidden",r)},this.setResultsDisplay=function(r){this.showResults=r,this.showResultsButtonEl.toggleClass("is-active",r),this.el.toggleClass("is-hidden",r)},this.setCollapseAll=function(r){this.collapseAllButtonEl.toggleClass("is-active",r),this.collapseAll=r,this.children.forEach(y=>{y.setCollapse(r,!1)}),this.infinityScroll.invalidateAll()},this.setSortOrder=r=>{this.sortOrder=r,this.changed()},this.onCopyResultsClick=r=>{r.preventDefault(),new t.SearchResultsExport(this.app,this).open()};let d=t.SearchHeaderDom?t.SearchHeaderDom:t.getSearchHeader(),h=this.headerDom=new d(this.app,this.el.parentElement);a.insertAdjacentElement("afterend",h.navHeaderEl),this.collapseAllButtonEl=h.addNavButton("bullet-list",p("plugins.search.label-collapse-results"),()=>this.setCollapseAll(!this.collapseAll)),this.extraContextButtonEl=h.addNavButton("expand-vertically",p("plugins.search.label-more-context"),()=>this.setExtraContext(!this.extraContext)),h.addSortButton(r=>this.setSortOrder(r),()=>this.sortOrder),this.showTitleButtonEl=h.addNavButton("strikethrough-glyph","Hide title",()=>this.setTitleDisplay(!this.showTitle)),this.showResultsButtonEl=h.addNavButton("lines-of-text","Hide results",()=>this.setResultsDisplay(!this.showResults)),h.addNavButton("documents","Copy results",this.onCopyResultsClick.bind(this));let m={title:t.settings.defaultHideResults,collapsed:t.settings.defaultCollapse,context:t.settings.defaultShowContext,hideTitle:t.settings.defaultHideTitle,hideResults:t.settings.defaultHideResults,sort:t.settings.defaultSortOrder};this.settings||(this.settings={}),Object.entries(m).forEach(([r,y])=>{this.settings.hasOwnProperty(r)?r==="sort"&&!S.hasOwnProperty(this.settings.sort)&&(this.settings[r]=y):this.settings[r]=y}),this.setExtraContext(this.settings.context),this.sortOrder=this.settings.sort,this.setCollapseAll(this.settings.collapsed),this.setTitleDisplay(this.settings.hideTitle),this.setResultsDisplay(this.settings.hideResults)}}catch(a){console.log(a)}return l.call(this,...n)}}}))}};
