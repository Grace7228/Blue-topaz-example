/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var yn=Object.create;var fe=Object.defineProperty;var Fn=Object.getOwnPropertyDescriptor;var wn=Object.getOwnPropertyNames,Ft=Object.getOwnPropertySymbols,bn=Object.getPrototypeOf,wt=Object.prototype.hasOwnProperty,xn=Object.prototype.propertyIsEnumerable;var bt=(t,e,n)=>e in t?fe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xt=(t,e)=>{for(var n in e||(e={}))wt.call(e,n)&&bt(t,n,e[n]);if(Ft)for(var n of Ft(e))xn.call(e,n)&&bt(t,n,e[n]);return t};var Et=t=>fe(t,"__esModule",{value:!0});var En=(t,e)=>{Et(t);for(var n in e)fe(t,n,{get:e[n],enumerable:!0})},An=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of wn(e))!wt.call(t,r)&&r!=="default"&&fe(t,r,{get:()=>e[r],enumerable:!(n=Fn(e,r))||n.enumerable});return t},re=t=>An(Et(fe(t!=null?yn(bn(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);En(exports,{default:()=>gt});var He=re(require("obsidian"));var he=re(require("obsidian"));var z=function(){return z=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},z.apply(this,arguments)};function E(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function T(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(u){s={error:u}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}var Cn="ENTRIES",At="KEYS",Ct="VALUES",B="",Qe=function(){function t(e,n){var r=e._tree,i=Array.from(r.keys());this.set=e,this._type=n,this._path=i.length>0?[{node:r,keys:i}]:[]}return t.prototype.next=function(){var e=this.dive();return this.backtrack(),e},t.prototype.dive=function(){if(this._path.length===0)return{done:!0,value:void 0};var e=le(this._path),n=e.node,r=e.keys;if(le(r)===B)return{done:!1,value:this.result()};var i=n.get(le(r));return this._path.push({node:i,keys:Array.from(i.keys())}),this.dive()},t.prototype.backtrack=function(){if(this._path.length!==0){var e=le(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}},t.prototype.key=function(){return this.set._prefix+this._path.map(function(e){var n=e.keys;return le(n)}).filter(function(e){return e!==B}).join("")},t.prototype.value=function(){return le(this._path).node.get(B)},t.prototype.result=function(){switch(this._type){case Ct:return this.value();case At:return this.key();default:return[this.key(),this.value()]}},t.prototype[Symbol.iterator]=function(){return this},t}(),le=function(t){return t[t.length-1]},kn=function(t,e,n){var r=new Map;if(e===void 0)return r;for(var i=e.length+1,o=i+n,s=new Uint8Array(o*i).fill(n+1),u=0;u<i;++u)s[u]=u;for(var l=1;l<o;++l)s[l*i]=l;return kt(t,e,n,r,s,1,i,""),r},kt=function(t,e,n,r,i,o,s,u){var l,a,c=o*s;try{e:for(var f=E(t.keys()),p=f.next();!p.done;p=f.next()){var d=p.value;if(d===B){var m=i[c-1];m<=n&&r.set(u,[t.get(d),m])}else{for(var y=o,h=0;h<d.length;++h,++y){for(var v=d[h],_=s*y,g=_-s,b=i[_],x=Math.max(0,y-n-1),A=Math.min(s-1,y+n),S=x;S<A;++S){var C=v!==e[S],N=i[g+S]+ +C,P=i[g+S+1]+1,I=i[_+S]+1,L=i[_+S+1]=Math.min(N,P,I);L<b&&(b=L)}if(b>n)continue e}kt(t.get(d),e,n,r,i,y,s,u+d)}}}catch(R){l={error:R}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(l)throw l.error}}},Ge=function(){function t(e,n){e===void 0&&(e=new Map),n===void 0&&(n=""),this._size=void 0,this._tree=e,this._prefix=n}return t.prototype.atPrefix=function(e){var n,r;if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var i=T(be(this._tree,e.slice(this._prefix.length)),2),o=i[0],s=i[1];if(o===void 0){var u=T(qe(s),2),l=u[0],a=u[1];try{for(var c=E(l.keys()),f=c.next();!f.done;f=c.next()){var p=f.value;if(p!==B&&p.startsWith(a)){var d=new Map;return d.set(p.slice(a.length),l.get(p)),new t(d,e)}}}catch(m){n={error:m}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}return new t(o,e)},t.prototype.clear=function(){this._size=void 0,this._tree.clear()},t.prototype.delete=function(e){return this._size=void 0,Sn(this._tree,e)},t.prototype.entries=function(){return new Qe(this,Cn)},t.prototype.forEach=function(e){var n,r;try{for(var i=E(this),o=i.next();!o.done;o=i.next()){var s=T(o.value,2),u=s[0],l=s[1];e(u,l,this)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.fuzzyGet=function(e,n){return kn(this._tree,e,n)},t.prototype.get=function(e){var n=Je(this._tree,e);return n!==void 0?n.get(B):void 0},t.prototype.has=function(e){var n=Je(this._tree,e);return n!==void 0&&n.has(B)},t.prototype.keys=function(){return new Qe(this,At)},t.prototype.set=function(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=Ye(this._tree,e);return r.set(B,n),this},Object.defineProperty(t.prototype,"size",{get:function(){if(this._size)return this._size;this._size=0;for(var e=this.entries();!e.next().done;)this._size+=1;return this._size},enumerable:!1,configurable:!0}),t.prototype.update=function(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=Ye(this._tree,e);return r.set(B,n(r.get(B))),this},t.prototype.fetch=function(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=Ye(this._tree,e),i=r.get(B);return i===void 0&&r.set(B,i=n()),i},t.prototype.values=function(){return new Qe(this,Ct)},t.prototype[Symbol.iterator]=function(){return this.entries()},t.from=function(e){var n,r,i=new t;try{for(var o=E(e),s=o.next();!s.done;s=o.next()){var u=T(s.value,2),l=u[0],a=u[1];i.set(l,a)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},t.fromObject=function(e){return t.from(Object.entries(e))},t}(),be=function(t,e,n){var r,i;if(n===void 0&&(n=[]),e.length===0||t==null)return[t,n];try{for(var o=E(t.keys()),s=o.next();!s.done;s=o.next()){var u=s.value;if(u!==B&&e.startsWith(u))return n.push([t,u]),be(t.get(u),e.slice(u.length),n)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return n.push([t,e]),be(void 0,"",n)},Je=function(t,e){var n,r;if(e.length===0||t==null)return t;try{for(var i=E(t.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;if(s!==B&&e.startsWith(s))return Je(t.get(s),e.slice(s.length))}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},Ye=function(t,e){var n,r,i=e.length;e:for(var o=0;t&&o<i;){try{for(var s=(n=void 0,E(t.keys())),u=s.next();!u.done;u=s.next()){var l=u.value;if(l!==B&&e[o]===l[0]){for(var a=Math.min(i-o,l.length),c=1;c<a&&e[o+c]===l[c];)++c;var f=t.get(l);if(c===l.length)t=f;else{var p=new Map;p.set(l.slice(c),f),t.set(e.slice(o,o+c),p),t.delete(l),t=p}o+=c;continue e}}}catch(m){n={error:m}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}var d=new Map;return t.set(e.slice(o),d),d}return t},Sn=function(t,e){var n=T(be(t,e),2),r=n[0],i=n[1];if(r!==void 0){if(r.delete(B),r.size===0)St(i);else if(r.size===1){var o=T(r.entries().next().value,2),s=o[0],u=o[1];Mt(i,s,u)}}},St=function(t){if(t.length!==0){var e=T(qe(t),2),n=e[0],r=e[1];if(n.delete(r),n.size===0)St(t.slice(0,-1));else if(n.size===1){var i=T(n.entries().next().value,2),o=i[0],s=i[1];o!==B&&Mt(t.slice(0,-1),o,s)}}},Mt=function(t,e,n){if(t.length!==0){var r=T(qe(t),2),i=r[0],o=r[1];i.set(o+e,n),i.delete(o)}},qe=function(t){return t[t.length-1]},de,Ke="or",Mn="and",Dn="and_not",Dt=function(){function t(e){if((e==null?void 0:e.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');this._options=z(z(z({},Ze),e),{searchOptions:z(z({},zt),e.searchOptions||{})}),this._index=new Ge,this._documentCount=0,this._documentIds=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this.addFields(this._options.fields)}return t.prototype.add=function(e){var n,r,i,o,s=this._options,u=s.extractField,l=s.tokenize,a=s.processTerm,c=s.fields,f=s.idField,p=u(e,f);if(p==null)throw new Error('MiniSearch: document does not have ID field "'.concat(f,'"'));var d=this.addDocumentId(p);this.saveStoredFields(d,e);try{for(var m=E(c),y=m.next();!y.done;y=m.next()){var h=y.value,v=u(e,h);if(v!=null){var _=l(v.toString(),h),g=this._fieldIds[h],b=new Set(_).size;this.addFieldLength(d,g,this._documentCount-1,b);try{for(var x=(i=void 0,E(_)),A=x.next();!A.done;A=x.next()){var S=A.value,C=a(S,h);C&&this.addTerm(g,d,C)}}catch(N){i={error:N}}finally{try{A&&!A.done&&(o=x.return)&&o.call(x)}finally{if(i)throw i.error}}}}}catch(N){n={error:N}}finally{try{y&&!y.done&&(r=m.return)&&r.call(m)}finally{if(n)throw n.error}}},t.prototype.addAll=function(e){var n,r;try{for(var i=E(e),o=i.next();!o.done;o=i.next()){var s=o.value;this.add(s)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.addAllAsync=function(e,n){var r=this;n===void 0&&(n={});var i=n.chunkSize,o=i===void 0?10:i,s={chunk:[],promise:Promise.resolve()},u=e.reduce(function(c,f,p){var d=c.chunk,m=c.promise;return d.push(f),(p+1)%o==0?{chunk:[],promise:m.then(function(){return new Promise(function(y){return setTimeout(y,0)})}).then(function(){return r.addAll(d)})}:{chunk:d,promise:m}},s),l=u.chunk,a=u.promise;return a.then(function(){return r.addAll(l)})},t.prototype.remove=function(e){var n,r,i,o,s,u,l=this._options,a=l.tokenize,c=l.processTerm,f=l.extractField,p=l.fields,d=l.idField,m=f(e,d);if(m==null)throw new Error('MiniSearch: document does not have ID field "'.concat(d,'"'));try{for(var y=E(this._documentIds),h=y.next();!h.done;h=y.next()){var v=T(h.value,2),_=v[0],g=v[1];if(m===g){try{for(var b=(i=void 0,E(p)),x=b.next();!x.done;x=b.next()){var A=x.value,S=f(e,A);if(S!=null){var C=a(S.toString(),A),N=this._fieldIds[A],P=new Set(C).size;this.removeFieldLength(_,N,this._documentCount,P);try{for(var I=(s=void 0,E(C)),L=I.next();!L.done;L=I.next()){var R=L.value,ee=c(R,A);ee&&this.removeTerm(N,_,ee)}}catch(Y){s={error:Y}}finally{try{L&&!L.done&&(u=I.return)&&u.call(I)}finally{if(s)throw s.error}}}}}catch(Y){i={error:Y}}finally{try{x&&!x.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}this._storedFields.delete(_),this._documentIds.delete(_),this._fieldLength.delete(_),this._documentCount-=1;return}}}catch(Y){n={error:Y}}finally{try{h&&!h.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}throw new Error("MiniSearch: cannot remove document with ID ".concat(m,": it is not in the index"))},t.prototype.removeAll=function(e){var n,r;if(e)try{for(var i=E(e),o=i.next();!o.done;o=i.next()){var s=o.value;this.remove(s)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new Ge,this._documentCount=0,this._documentIds=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}},t.prototype.search=function(e,n){var r,i;n===void 0&&(n={});var o=this.executeQuery(e,n),s=[];try{for(var u=E(o),l=u.next();!l.done;l=u.next()){var a=T(l.value,2),c=a[0],f=a[1],p=f.score,d=f.terms,m=f.match,y=d.length,h={id:this._documentIds.get(c),score:p*y,terms:Object.keys(m),match:m};Object.assign(h,this._storedFields.get(c)),(n.filter==null||n.filter(h))&&s.push(h)}}catch(v){r={error:v}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s.sort(Bt),s},t.prototype.autoSuggest=function(e,n){var r,i,o,s;n===void 0&&(n={}),n=z(z({},Bn),n);var u=new Map;try{for(var l=E(this.search(e,n)),a=l.next();!a.done;a=l.next()){var c=a.value,f=c.score,p=c.terms,d=p.join(" "),m=u.get(d);m!=null?(m.score+=f,m.count+=1):u.set(d,{score:f,terms:p,count:1})}}catch(x){r={error:x}}finally{try{a&&!a.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}var y=[];try{for(var h=E(u),v=h.next();!v.done;v=h.next()){var _=T(v.value,2),m=_[0],g=_[1],f=g.score,p=g.terms,b=g.count;y.push({suggestion:m,terms:p,score:f/b})}}catch(x){o={error:x}}finally{try{v&&!v.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}return y.sort(Bt),y},Object.defineProperty(t.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),t.loadJSON=function(e,n){if(n==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return t.loadJS(JSON.parse(e),n)},t.getDefault=function(e){if(Ze.hasOwnProperty(e))return Xe(Ze,e);throw new Error('MiniSearch: unknown option "'.concat(e,'"'))},t.loadJS=function(e,n){var r,i,o,s,u=e.index,l=e.documentCount,a=e.nextId,c=e.documentIds,f=e.fieldIds,p=e.fieldLength,d=e.averageFieldLength,m=e.storedFields,y=e.serializationVersion;if(y!==1&&y!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");var h=new t(n);h._documentCount=l,h._nextId=a,h._documentIds=xe(c),h._fieldIds=f,h._fieldLength=xe(p),h._avgFieldLength=d,h._storedFields=xe(m),h._index=new Ge;try{for(var v=E(u),_=v.next();!_.done;_=v.next()){var g=T(_.value,2),b=g[0],x=g[1],A=new Map;try{for(var S=(o=void 0,E(Object.keys(x))),C=S.next();!C.done;C=S.next()){var N=C.value,P=x[N];y===1&&(P=P.ds),A.set(parseInt(N,10),xe(P))}}catch(I){o={error:I}}finally{try{C&&!C.done&&(s=S.return)&&s.call(S)}finally{if(o)throw o.error}}h._index.set(b,A)}}catch(I){r={error:I}}finally{try{_&&!_.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}return h},t.prototype.executeQuery=function(e,n){var r=this;if(n===void 0&&(n={}),typeof e!="string"){var i=z(z(z({},n),e),{queries:void 0}),o=e.queries.map(function(h){return r.executeQuery(h,i)});return this.combineResults(o,e.combineWith)}var s=this._options,u=s.tokenize,l=s.processTerm,a=s.searchOptions,c=z(z({tokenize:u,processTerm:l},a),n),f=c.tokenize,p=c.processTerm,d=f(e).map(function(h){return p(h)}).filter(function(h){return!!h}),m=d.map(Tn(c)),y=m.map(function(h){return r.executeQuerySpec(h,c)});return this.combineResults(y,c.combineWith)},t.prototype.executeQuerySpec=function(e,n){var r,i,o,s,u=z(z({},this._options.searchOptions),n),l=(u.fields||this._options.fields).reduce(function(ue,yt){var Ue;return z(z({},ue),(Ue={},Ue[yt]=Xe(ue,yt)||1,Ue))},u.boost||{}),a=u.boostDocument,c=u.weights,f=u.maxFuzzy,p=z(z({},zt.weights),c),d=p.fuzzy,m=p.prefix,y=this._index.get(e.term),h=this.termResults(e.term,e.term,1,y,l,a),v,_;if(e.prefix&&(v=this._index.atPrefix(e.term)),e.fuzzy){var g=e.fuzzy===!0?.2:e.fuzzy,b=g<1?Math.min(f,Math.round(e.term.length*g)):g;b&&(_=this._index.fuzzyGet(e.term,b))}if(v)try{for(var x=E(v),A=x.next();!A.done;A=x.next()){var S=T(A.value,2),C=S[0],N=S[1],P=C.length-e.term.length;if(!!P){_==null||_.delete(C);var I=m*C.length/(C.length+.3*P);this.termResults(e.term,C,I,N,l,a,h)}}}catch(ue){r={error:ue}}finally{try{A&&!A.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}if(_)try{for(var L=E(_.keys()),R=L.next();!R.done;R=L.next()){var C=R.value,ee=T(_.get(C),2),Y=ee[0],P=ee[1];if(!!P){var I=d*C.length/(C.length+P);this.termResults(e.term,C,I,Y,l,a,h)}}}catch(ue){o={error:ue}}finally{try{R&&!R.done&&(s=L.return)&&s.call(L)}finally{if(o)throw o.error}}return h},t.prototype.combineResults=function(e,n){if(n===void 0&&(n=Ke),e.length===0)return new Map;var r=n.toLowerCase();return e.reduce($n[r])||new Map},t.prototype.toJSON=function(){var e,n,r,i,o=[];try{for(var s=E(this._index),u=s.next();!u.done;u=s.next()){var l=T(u.value,2),a=l[0],c=l[1],f={};try{for(var p=(r=void 0,E(c)),d=p.next();!d.done;d=p.next()){var m=T(d.value,2),y=m[0],h=m[1];f[y]=Object.fromEntries(h)}}catch(v){r={error:v}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}o.push([a,f])}}catch(v){e={error:v}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),index:o,serializationVersion:2}},t.prototype.termResults=function(e,n,r,i,o,s,u){var l,a,c,f,p;if(u===void 0&&(u=new Map),i==null)return u;try{for(var d=E(Object.keys(o)),m=d.next();!m.done;m=d.next()){var y=m.value,h=o[y],v=this._fieldIds[y],_=i.get(v);if(_!=null){var g=_.size,b=this._avgFieldLength[v];try{for(var x=(c=void 0,E(_.keys())),A=x.next();!A.done;A=x.next()){var S=A.value,C=s?s(this._documentIds.get(S),n):1;if(!!C){var N=_.get(S),P=this._fieldLength.get(S)[v],I=zn(N,g,this._documentCount,P,b),L=r*h*C*I,R=u.get(S);if(R){R.score+=L,In(R.terms,e);var ee=Xe(R.match,n);ee?ee.push(y):R.match[n]=[y]}else u.set(S,{score:L,terms:[e],match:(p={},p[n]=[y],p)})}}}catch(Y){c={error:Y}}finally{try{A&&!A.done&&(f=x.return)&&f.call(x)}finally{if(c)throw c.error}}}}}catch(Y){l={error:Y}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(l)throw l.error}}return u},t.prototype.addTerm=function(e,n,r){var i=this._index.fetch(r,It),o=i.get(e);if(o==null)o=new Map,o.set(n,1),i.set(e,o);else{var s=o.get(n);o.set(n,(s||0)+1)}},t.prototype.removeTerm=function(e,n,r){if(!this._index.has(r)){this.warnDocumentChanged(n,e,r);return}var i=this._index.fetch(r,It),o=i.get(e);o==null||o.get(n)==null?this.warnDocumentChanged(n,e,r):o.get(n)<=1?o.size<=1?i.delete(e):o.delete(n):o.set(n,o.get(n)-1),this._index.get(r).size===0&&this._index.delete(r)},t.prototype.warnDocumentChanged=function(e,n,r){var i,o;if(!(console==null||console.warn==null))try{for(var s=E(Object.keys(this._fieldIds)),u=s.next();!u.done;u=s.next()){var l=u.value;if(this._fieldIds[l]===n){console.warn("MiniSearch: document with ID ".concat(this._documentIds.get(e),' has changed before removal: term "').concat(r,'" was not present in field "').concat(l,'". Removing a document after it has changed can corrupt the index!'));return}}}catch(a){i={error:a}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},t.prototype.addDocumentId=function(e){var n=this._nextId;return this._documentIds.set(n,e),this._documentCount+=1,this._nextId+=1,n},t.prototype.addFields=function(e){for(var n=0;n<e.length;n++)this._fieldIds[e[n]]=n},t.prototype.addFieldLength=function(e,n,r,i){var o=this._fieldLength.get(e);o==null&&this._fieldLength.set(e,o=[]),o[n]=i;var s=this._avgFieldLength[n]||0,u=s*r+i;this._avgFieldLength[n]=u/(r+1)},t.prototype.removeFieldLength=function(e,n,r,i){var o=this._avgFieldLength[n]*r-i;this._avgFieldLength[n]=o/(r-1)},t.prototype.saveStoredFields=function(e,n){var r,i,o=this._options,s=o.storeFields,u=o.extractField;if(!(s==null||s.length===0)){var l=this._storedFields.get(e);l==null&&this._storedFields.set(e,l={});try{for(var a=E(s),c=a.next();!c.done;c=a.next()){var f=c.value,p=u(n,f);p!==void 0&&(l[f]=p)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}},t}(),Xe=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},$n=(de={},de[Ke]=function(t,e){var n,r;try{for(var i=E(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value,u=t.get(s);if(u==null)t.set(s,e.get(s));else{var l=e.get(s),a=l.score,c=l.terms,f=l.match;u.score=u.score+a,u.match=Object.assign(u.match,f),Tt(u.terms,c)}}}catch(p){n={error:p}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},de[Mn]=function(t,e){var n,r,i=new Map;try{for(var o=E(e.keys()),s=o.next();!s.done;s=o.next()){var u=s.value,l=t.get(u);if(l!=null){var a=e.get(u),c=a.score,f=a.terms,p=a.match;Tt(l.terms,f),i.set(u,{score:l.score+c,terms:l.terms,match:Object.assign(l.match,p)})}}}catch(d){n={error:d}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},de[Dn]=function(t,e){var n,r;try{for(var i=E(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;t.delete(s)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},de),$t=1.2,Ot=.7,On=.5,zn=function(t,e,n,r,i){var o=Math.log(1+(n-e+.5)/(e+.5));return o*(On+t*($t+1)/(t+$t*(1-Ot+Ot*r/i)))},Tn=function(t){return function(e,n,r){var i=typeof t.fuzzy=="function"?t.fuzzy(e,n,r):t.fuzzy||!1,o=typeof t.prefix=="function"?t.prefix(e,n,r):t.prefix===!0;return{term:e,fuzzy:i,prefix:o}}},Ze={idField:"id",extractField:function(t,e){return t[e]},tokenize:function(t,e){return t.split(Ln)},processTerm:function(t,e){return t.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[]},zt={combineWith:Ke,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375}},Bn={prefix:function(t,e,n){return e===n.length-1}},In=function(t,e){t.includes(e)||t.push(e)},Tt=function(t,e){var n,r;try{for(var i=E(e),o=i.next();!o.done;o=i.next()){var s=o.value;t.includes(s)||t.push(s)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},Bt=function(t,e){var n=t.score,r=e.score;return r-n},It=function(){return new Map},xe=function(t){var e,n,r=new Map;try{for(var i=E(Object.keys(t)),o=i.next();!o.done;o=i.next()){var s=o.value;r.set(parseInt(s,10),t[s])}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},Ln=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;var et=class{constructor(){this.handlers=new Map;this.disabled=[]}on(e,n,r){if(e.includes("@")||n.includes("@"))throw new Error("Invalid context/event name - Cannot contain @");this.handlers.set(`${e}@${n}`,r)}off(e,n){if(n)this.handlers.delete(`${e}@${n}`);else for(let[r]of this.handlers.entries())r.startsWith(`${e}@`)&&this.handlers.delete(r)}disable(e){this.enable(e),this.disabled.push(e)}enable(e){this.disabled=this.disabled.filter(n=>n!==e)}emit(e,...n){for(let[r,i]of this.handlers.entries()){let o=r.split("@")[0];this.disabled.includes(o)||r.endsWith(`@${e}`)&&i(...n)}}};var Lt=100,Ee=180,Nt="suggestion-highlight omnisearch-highlight",O=new et;var Pt=/[|\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;function te(t){return`<span class="${Nt}">${t}</span>`}function Nn(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function Rt(t){return new Promise(e=>{setTimeout(e,t)})}function Pn(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function ne(t){return new RegExp(t.map(Pn).join("|"),"gi")}function Ae(t,e){return t.headings?.filter(n=>n.level===e).map(n=>n.heading)??[]}function Ce(t,e){return(t+e)%e}function ke(t,e){let n=e??-1;if(n>-1){let r=Math.max(0,n-Lt),i=Math.min(t.length-1,n+Ee);t=(r>0?"\u2026":"")+t.slice(r,i).trim()+(i<t.length-1?"\u2026":"")}return Nn(t)}var Se,ae={};async function jt(){ae={},Se=new Dt({tokenize:n=>n.split(Pt),idField:"path",fields:["basename","content","headings1","headings2","headings3"]});let t=new Date().getTime(),e=app.vault.getMarkdownFiles();e.length&&console.log("Omnisearch - indexing "+e.length+" files");for(let n=0;n<e.length;++n){n%10==0&&await Rt(0);let r=e[n];r&&await pe(r)}e.length>0&&new he.Notice(`Omnisearch - Indexed ${e.length} notes in ${new Date().getTime()-t}ms`)}function Rn(t){return t?Se.search(t,{prefix:!0,fuzzy:e=>e.length>4?.2:!1,combineWith:"AND",boost:{basename:2,headings1:1.5,headings2:1.3,headings3:1.1}}):[]}function tt(t,e){let n=null,r=[];for(;(n=e.exec(t))!==null;){let i=n[0];i&&r.push({match:i,offset:n.index})}return r}function Me(t,e){let n=Rn(t);if(!n.length)return[];if(e?.singleFilePath){let i=n.find(o=>o.id===e.singleFilePath);i?n=[i]:n=[]}else n=n.sort((i,o)=>o.score-i.score).slice(0,50);return n.map(i=>{let o=ae[i.id];if(!o)throw new Error(`Note "${i.id}" not indexed`);let s=Object.keys(i.match),u=tt(o.content,ne(s));return xt({score:i.score,foundWords:s,matches:u},o)})}async function pe(t){if(!(!(t instanceof he.TFile)||t.extension!=="md"))try{let e=app.metadataCache.getFileCache(t);if(ae[t.path])throw new Error(`${t.basename} is already indexed`);let n=await app.vault.cachedRead(t),r={basename:t.basename,content:n,path:t.path,headings1:e?Ae(e,1).join(" "):"",headings2:e?Ae(e,2).join(" "):"",headings3:e?Ae(e,3).join(" "):""};Se.add(r),ae[r.path]=r}catch(e){console.trace("Error while indexing "+t.basename),console.error(e)}}function nt(t){if(t instanceof he.TFile&&t.path.endsWith(".md"))return rt(t.path)}function rt(t){let e=ae[t];e&&(Se.remove(e),delete ae[t])}var gn=re(require("obsidian"));function q(){}function jn(t,e){for(let n in e)t[n]=e[n];return t}function it(t){return t()}function Vt(){return Object.create(null)}function K(t){t.forEach(it)}function Wt(t){return typeof t=="function"}function W(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ht(t){return Object.keys(t).length===0}function De(t,e,n,r){if(t){let i=Ut(t,e,n,r);return t[0](i)}}function Ut(t,e,n,r){return t[1]&&r?jn(n.ctx.slice(),t[1](r(e))):n.ctx}function $e(t,e,n,r){if(t[2]&&r){let i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){let o=[],s=Math.max(e.dirty.length,i.length);for(let u=0;u<s;u+=1)o[u]=e.dirty[u]|i[u];return o}return e.dirty|i}return e.dirty}function Oe(t,e,n,r,i,o){if(i){let s=Ut(e,n,r,o);t.p(s,i)}}function ze(t){if(t.ctx.length>32){let e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}var zr=new Set;var Qt=!1;function Vn(){Qt=!0}function Wn(){Qt=!1}function G(t,e){t.appendChild(e)}function w(t,e,n){t.insertBefore(e,n||null)}function F(t){t.parentNode.removeChild(t)}function Te(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function M(t){return document.createElement(t)}function ce(t){return document.createTextNode(t)}function j(){return ce(" ")}function me(){return ce("")}function Z(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function k(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Hn(t){return Array.from(t.childNodes)}function ot(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function st(t,e){t.value=e??""}function ut(t,e,n){t.classList[n?"add":"remove"](e)}function Un(t,e,n=!1){let r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}var Tr=new Map;var ve;function _e(t){ve=t}function lt(){if(!ve)throw new Error("Function called outside component initialization");return ve}function ie(t){lt().$$.on_mount.push(t)}function at(t){lt().$$.on_destroy.push(t)}function ct(){let t=lt();return(e,n)=>{let r=t.$$.callbacks[e];if(r){let i=Un(e,n);r.slice().forEach(o=>{o.call(t,i)})}}}function X(t,e){let n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}var ge=[];var Be=[],Ie=[],Gt=[],Jt=Promise.resolve(),ft=!1;function Yt(){ft||(ft=!0,Jt.then(qt))}function oe(){return Yt(),Jt}function dt(t){Ie.push(t)}var ht=new Set,Le=0;function qt(){let t=ve;do{for(;Le<ge.length;){let e=ge[Le];Le++,_e(e),Qn(e.$$)}for(_e(null),ge.length=0,Le=0;Be.length;)Be.pop()();for(let e=0;e<Ie.length;e+=1){let n=Ie[e];ht.has(n)||(ht.add(n),n())}Ie.length=0}while(ge.length);for(;Gt.length;)Gt.pop()();ft=!1,ht.clear(),_e(t)}function Qn(t){if(t.fragment!==null){t.update(),K(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(dt)}}var Ne=new Set,se;function ye(){se={r:0,c:[],p:se}}function Fe(){se.r||K(se.c),se=se.p}function D(t,e){t&&t.i&&(Ne.delete(t),t.i(e))}function $(t,e,n,r){if(t&&t.o){if(Ne.has(t))return;Ne.add(t),se.c.push(()=>{Ne.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}var Br=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;var Ir=new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);function J(t){t&&t.c()}function Q(t,e,n,r){let{fragment:i,on_mount:o,on_destroy:s,after_update:u}=t.$$;i&&i.m(e,n),r||dt(()=>{let l=o.map(it).filter(Wt);s?s.push(...l):K(l),t.$$.on_mount=[]}),u.forEach(dt)}function H(t,e){let n=t.$$;n.fragment!==null&&(K(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Gn(t,e){t.$$.dirty[0]===-1&&(ge.push(t),Yt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function U(t,e,n,r,i,o,s,u=[-1]){let l=ve;_e(t);let a=t.$$={fragment:null,ctx:null,props:o,update:q,not_equal:i,bound:Vt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Vt(),dirty:u,skip_bound:!1,root:e.target||l.$$.root};s&&s(a.root);let c=!1;if(a.ctx=n?n(t,e.props||{},(f,p,...d)=>{let m=d.length?d[0]:p;return a.ctx&&i(a.ctx[f],a.ctx[f]=m)&&(!a.skip_bound&&a.bound[f]&&a.bound[f](m),c&&Gn(t,f)),p}):[],a.update(),c=!0,K(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){Vn();let f=Hn(e.target);a.fragment&&a.fragment.l(f),f.forEach(F)}else a.fragment&&a.fragment.c();e.intro&&D(t.$$.fragment),Q(t,e.target,e.anchor,e.customElement),Wn(),qt()}_e(l)}var Jn;typeof HTMLElement=="function"&&(Jn=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(it).filter(Wt);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){K(this.$$.on_disconnect)}$destroy(){H(this,1),this.$destroy=q}$on(t,e){let n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{let r=n.indexOf(e);r!==-1&&n.splice(r,1)}}$set(t){this.$$set&&!Ht(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});var V=class{$destroy(){H(this,1),this.$destroy=q}$on(e,n){let r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{let i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Ht(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var on=re(require("obsidian"));var Kt=re(require("obsidian"));function Yn(t){let e,n,r;return{c(){e=M("input"),k(e,"type","text"),k(e,"class","prompt-input"),k(e,"placeholder","Type to search through your notes"),k(e,"spellcheck","false")},m(i,o){w(i,e,o),st(e,t[0]),t[4](e),n||(r=[Z(e,"input",t[3]),Z(e,"input",t[2])],n=!0)},p(i,[o]){o&1&&e.value!==i[0]&&st(e,i[0])},i:q,o:q,d(i){i&&F(e),t[4](null),n=!1,K(r)}}}function qn(t,e,n){let{value:r=""}=e,i=ct(),o;ie(async()=>{await oe(),o.focus(),o.select()});let s=(0,Kt.debounce)(()=>{i("input",r)},100);function u(){r=this.value,n(0,r)}function l(a){Be[a?"unshift":"push"](()=>{o=a,n(1,o)})}return t.$$set=a=>{"value"in a&&n(0,r=a.value)},[r,o,s,u,l]}var Xt=class extends V{constructor(e){super();U(this,e,qn,Yn,W,{value:0})}},Pe=Xt;function Kn(t){let e,n,r,i,o=t[1].default,s=De(o,t,t[0],null);return{c(){e=M("div"),s&&s.c(),k(e,"class","prompt-results")},m(u,l){w(u,e,l),s&&s.m(e,null),n=!0,r||(i=Z(e,"mousedown",Xn),r=!0)},p(u,[l]){s&&s.p&&(!n||l&1)&&Oe(s,o,u,u[0],n?$e(o,u[0],l,null):ze(u[0]),null)},i(u){n||(D(s,u),n=!0)},o(u){$(s,u),n=!1},d(u){u&&F(e),s&&s.d(u),r=!1,i()}}}var Xn=t=>t.preventDefault();function Zn(t,e,n){let{$$slots:r={},$$scope:i}=e;return t.$$set=o=>{"$$scope"in o&&n(0,i=o.$$scope)},[i,r]}var Zt=class extends V{constructor(e){super();U(this,e,Zn,Kn,W,{})}},Re=Zt;var pt=re(require("obsidian"));async function je(t,e=!1){let n=ne(t.foundWords);n.exec(t.content);let r=n.lastIndex;await app.workspace.openLinkText(t.path,"",e);let i=app.workspace.getActiveViewOfType(pt.MarkdownView);if(!i)throw new Error("OmniSearch - No active MarkdownView");let o=i.editor.offsetToPos(r);o.ch=0,i.editor.setCursor(o),i.editor.scrollIntoView({from:{line:o.line-10,ch:0},to:{line:o.line+10,ch:0}})}async function en(t){try{let e=await app.vault.create(t+".md","# "+t+`
`);await app.workspace.openLinkText(e.path,"");let n=app.workspace.getActiveViewOfType(pt.MarkdownView);if(!n)throw new Error("OmniSearch - No active MarkdownView");let r=n.editor.offsetToPos(t.length+5);r.ch=0}catch(e){console.error(e)}}function er(t){let e,n,r,i,o=t[3].default,s=De(o,t,t[2],null);return{c(){e=M("div"),s&&s.c(),k(e,"data-result-id",t[0]),k(e,"class","suggestion-item omnisearch-result"),ut(e,"is-selected",t[1])},m(u,l){w(u,e,l),s&&s.m(e,null),n=!0,r||(i=[Z(e,"mousemove",t[4]),Z(e,"click",t[5]),Z(e,"auxclick",t[6])],r=!0)},p(u,[l]){s&&s.p&&(!n||l&4)&&Oe(s,o,u,u[2],n?$e(o,u[2],l,null):ze(u[2]),null),(!n||l&1)&&k(e,"data-result-id",u[0]),l&2&&ut(e,"is-selected",u[1])},i(u){n||(D(s,u),n=!0)},o(u){$(s,u),n=!1},d(u){u&&F(e),s&&s.d(u),r=!1,K(i)}}}function tr(t,e,n){let{$$slots:r={},$$scope:i}=e,{id:o}=e,{selected:s=!1}=e;function u(c){X.call(this,t,c)}function l(c){X.call(this,t,c)}function a(c){X.call(this,t,c)}return t.$$set=c=>{"id"in c&&n(0,o=c.id),"selected"in c&&n(1,s=c.selected),"$$scope"in c&&n(2,i=c.$$scope)},[o,s,i,r,u,l,a]}var tn=class extends V{constructor(e){super();U(this,e,tr,er,W,{id:0,selected:1})}},Ve=tn;function nr(t){let e,n=t[1].basename.replace(t[2],te)+"",r,i,o=t[4].length+"",s,u,l=(t[4].length>1?"matches":"match")+"",a,c,f,p=t[3].replace(t[2],te)+"";return{c(){e=M("span"),r=j(),i=M("span"),s=ce(o),u=ce("\xA0"),a=ce(l),c=j(),f=M("div"),k(e,"class","omnisearch-result__title"),k(i,"class","omnisearch-result__counter"),k(f,"class","omnisearch-result__body")},m(d,m){w(d,e,m),e.innerHTML=n,w(d,r,m),w(d,i,m),G(i,s),G(i,u),G(i,a),w(d,c,m),w(d,f,m),f.innerHTML=p},p(d,m){m&6&&n!==(n=d[1].basename.replace(d[2],te)+"")&&(e.innerHTML=n),m&16&&o!==(o=d[4].length+"")&&ot(s,o),m&16&&l!==(l=(d[4].length>1?"matches":"match")+"")&&ot(a,l),m&12&&p!==(p=d[3].replace(d[2],te)+"")&&(f.innerHTML=p)},d(d){d&&F(e),d&&F(r),d&&F(i),d&&F(c),d&&F(f)}}}function rr(t){let e,n;return e=new Ve({props:{id:t[1].path,selected:t[0],$$slots:{default:[nr]},$$scope:{ctx:t}}}),e.$on("mousemove",t[5]),e.$on("click",t[6]),{c(){J(e.$$.fragment)},m(r,i){Q(e,r,i),n=!0},p(r,[i]){let o={};i&2&&(o.id=r[1].path),i&1&&(o.selected=r[0]),i&158&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(D(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function ir(t,e,n){let r,i,o,{selected:s=!1}=e,{note:u}=e;function l(c){X.call(this,t,c)}function a(c){X.call(this,t,c)}return t.$$set=c=>{"selected"in c&&n(0,s=c.selected),"note"in c&&n(1,u=c.note)},t.$$.update=()=>{if(t.$$.dirty&2){e:n(2,r=ne(u.foundWords))}if(t.$$.dirty&6){e:n(4,i=tt(u.content,r))}if(t.$$.dirty&2){e:n(3,o=ke(u.content,u.matches[0]?.offset??-1))}},[s,u,r,o,i,l,a]}var nn=class extends V{constructor(e){super();U(this,e,ir,rr,W,{selected:0,note:1})}},rn=nn;function sn(t,e,n){let r=t.slice();return r[14]=e[n],r[16]=n,r}function un(t){let e,n;function r(...i){return t[6](t[16],...i)}return e=new rn({props:{selected:t[16]===t[0],note:t[14]}}),e.$on("mousemove",r),e.$on("click",t[3]),{c(){J(e.$$.fragment)},m(i,o){Q(e,i,o),n=!0},p(i,o){t=i;let s={};o&1&&(s.selected=t[16]===t[0]),o&4&&(s.note=t[14]),e.$set(s)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){$(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function ln(t){let e;return{c(){e=M("center"),e.textContent="We found 0 result for your search here."},m(n,r){w(n,e,r)},d(n){n&&F(e)}}}function or(t){let e,n,r,i=t[2],o=[];for(let l=0;l<i.length;l+=1)o[l]=un(sn(t,i,l));let s=l=>$(o[l],1,1,()=>{o[l]=null}),u=!t[2].length&&t[1]&&ln(t);return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=j(),u&&u.c(),n=me()},m(l,a){for(let c=0;c<o.length;c+=1)o[c].m(l,a);w(l,e,a),u&&u.m(l,a),w(l,n,a),r=!0},p(l,a){if(a&13){i=l[2];let c;for(c=0;c<i.length;c+=1){let f=sn(l,i,c);o[c]?(o[c].p(f,a),D(o[c],1)):(o[c]=un(f),o[c].c(),D(o[c],1),o[c].m(e.parentNode,e))}for(ye(),c=i.length;c<o.length;c+=1)s(c);Fe()}!l[2].length&&l[1]?u||(u=ln(l),u.c(),u.m(n.parentNode,n)):u&&(u.d(1),u=null)},i(l){if(!r){for(let a=0;a<i.length;a+=1)D(o[a]);r=!0}},o(l){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)$(o[a]);r=!1},d(l){Te(o,l),l&&F(e),u&&u.d(l),l&&F(n)}}}function sr(t){let e,n,r,i,o,s,u,l;return r=new Pe({props:{value:We}}),r.$on("input",t[5]),o=new Re({props:{$$slots:{default:[or]},$$scope:{ctx:t}}}),{c(){e=M("div"),e.textContent="Omnisearch - Vault",n=j(),J(r.$$.fragment),i=j(),J(o.$$.fragment),s=j(),u=M("div"),u.innerHTML=`<div class="prompt-instruction"><span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">alt \u21B5</span> 
    <span>to expand in-note results</span></div> 
  <br/> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">\u21B5</span><span>to open</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">ctrl \u21B5</span> 
    <span>to open in a new pane</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">shift \u21B5</span> 
    <span>to create</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">esc</span><span>to dismiss</span></div>`,k(e,"class","modal-title"),k(u,"class","prompt-instructions")},m(a,c){w(a,e,c),w(a,n,c),Q(r,a,c),w(a,i,c),Q(o,a,c),w(a,s,c),w(a,u,c),l=!0},p(a,[c]){let f={};c&0&&(f.value=We),r.$set(f);let p={};c&131079&&(p.$$scope={dirty:c,ctx:a}),o.$set(p)},i(a){l||(D(r.$$.fragment,a),D(o.$$.fragment,a),l=!0)},o(a){$(r.$$.fragment,a),$(o.$$.fragment,a),l=!1},d(a){a&&F(e),a&&F(n),H(r,a),a&&F(i),H(o,a),a&&F(s),a&&F(u)}}}var We="";function ur(t,e,n){let r,{modal:i}=e,o=0,s,u=[];ie(()=>{n(1,s=We),O.on("vault","enter",a),O.on("vault","shift-enter",f),O.on("vault","ctrl-enter",c),O.on("vault","alt-enter",p),O.on("vault","arrow-up",()=>d(-1)),O.on("vault","arrow-down",()=>d(1))});function l(){!r||(je(r),i.close())}function a(){!r||(je(r),i.close())}function c(){!r||(je(r,!0),i.close())}async function f(){await en(s),i.close()}function p(){if(r){let v=app.vault.getAbstractFileByPath(r.path);v&&v instanceof on.TFile&&new we(app,v,s,i).open()}}function d(v){n(0,o=Ce(o+v,u.length)),m()}async function m(){await oe(),r&&document.querySelector(`[data-result-id="${r.path}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}let y=v=>n(1,s=v.detail),h=(v,_)=>n(0,o=v);return t.$$set=v=>{"modal"in v&&n(4,i=v.modal)},t.$$.update=()=>{if(t.$$.dirty&2){e:s&&(n(2,u=Me(s)),We=s),n(0,o=0),m()}if(t.$$.dirty&5){e:r=u[o]}},[o,s,u,l,i,y,h]}var an=class extends V{constructor(e){super();U(this,e,ur,sr,W,{modal:4})}},cn=an;var hn=re(require("obsidian"));function lr(t){let e,n=t[2].replace(t[3],te)+"";return{c(){e=M("div"),k(e,"class","omnisearch-result__body")},m(r,i){w(r,e,i),e.innerHTML=n},p(r,i){i&12&&n!==(n=r[2].replace(r[3],te)+"")&&(e.innerHTML=n)},d(r){r&&F(e)}}}function ar(t){let e,n;return e=new Ve({props:{id:t[0].toString(),selected:t[1],$$slots:{default:[lr]},$$scope:{ctx:t}}}),e.$on("mousemove",t[6]),e.$on("click",t[7]),{c(){J(e.$$.fragment)},m(r,i){Q(e,r,i),n=!0},p(r,[i]){let o={};i&1&&(o.id=r[0].toString()),i&2&&(o.selected=r[1]),i&268&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(D(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function cr(t,e,n){let r,i,{offset:o}=e,{note:s}=e,{index:u=0}=e,{selected:l=!1}=e;function a(f){X.call(this,t,f)}function c(f){X.call(this,t,f)}return t.$$set=f=>{"offset"in f&&n(4,o=f.offset),"note"in f&&n(5,s=f.note),"index"in f&&n(0,u=f.index),"selected"in f&&n(1,l=f.selected)},t.$$.update=()=>{if(t.$$.dirty&32){e:n(3,r=ne(s.foundWords))}if(t.$$.dirty&48){e:n(2,i=ke(s?.content??"",o))}},[u,l,i,r,o,s,a,c]}var fn=class extends V{constructor(e){super();U(this,e,cr,ar,W,{offset:4,note:5,index:0,selected:1})}},dn=fn;function pn(t,e,n){let r=t.slice();return r[13]=e[n],r[15]=n,r}function fr(t){let e;return{c(){e=M("center"),e.textContent="We found 0 result for your search here."},m(n,r){w(n,e,r)},p:q,i:q,o:q,d(n){n&&F(e)}}}function dr(t){let e,n,r=t[3],i=[];for(let s=0;s<r.length;s+=1)i[s]=mn(pn(t,r,s));let o=s=>$(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=me()},m(s,u){for(let l=0;l<i.length;l+=1)i[l].m(s,u);w(s,e,u),n=!0},p(s,u){if(u&60){r=s[3];let l;for(l=0;l<r.length;l+=1){let a=pn(s,r,l);i[l]?(i[l].p(a,u),D(i[l],1)):(i[l]=mn(a),i[l].c(),D(i[l],1),i[l].m(e.parentNode,e))}for(ye(),l=r.length;l<i.length;l+=1)o(l);Fe()}},i(s){if(!n){for(let u=0;u<r.length;u+=1)D(i[u]);n=!0}},o(s){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)$(i[u]);n=!1},d(s){Te(i,s),s&&F(e)}}}function mn(t){let e,n;function r(...i){return t[9](t[15],...i)}return e=new dn({props:{offset:t[13],note:t[2],index:t[15],selected:t[15]===t[4]}}),e.$on("mousemove",r),e.$on("click",t[5]),{c(){J(e.$$.fragment)},m(i,o){Q(e,i,o),n=!0},p(i,o){t=i;let s={};o&8&&(s.offset=t[13]),o&4&&(s.note=t[2]),o&16&&(s.selected=t[15]===t[4]),e.$set(s)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){$(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function hr(t){let e,n,r,i,o=[dr,fr],s=[];function u(l,a){return l[3].length&&l[2]?0:1}return e=u(t,-1),n=s[e]=o[e](t),{c(){n.c(),r=me()},m(l,a){s[e].m(l,a),w(l,r,a),i=!0},p(l,a){let c=e;e=u(l,a),e===c?s[e].p(l,a):(ye(),$(s[c],1,1,()=>{s[c]=null}),Fe(),n=s[e],n?n.p(l,a):(n=s[e]=o[e](l),n.c()),D(n,1),n.m(r.parentNode,r))},i(l){i||(D(n),i=!0)},o(l){$(n),i=!1},d(l){s[e].d(l),l&&F(r)}}}function pr(t){let e;return{c(){e=M("span"),e.textContent="to dismiss"},m(n,r){w(n,e,r)},d(n){n&&F(e)}}}function mr(t){let e;return{c(){e=M("span"),e.textContent="to go back to Vault Search"},m(n,r){w(n,e,r)},d(n){n&&F(e)}}}function vr(t){let e,n,r,i,o,s,u,l,a,c,f,p,d,m,y;r=new Pe({props:{value:t[0]}}),r.$on("input",t[8]),o=new Re({props:{$$slots:{default:[hr]},$$scope:{ctx:t}}});function h(g,b){return g[1]?mr:pr}let v=h(t,-1),_=v(t);return{c(){e=M("div"),e.textContent="Omnisearch - File",n=j(),J(r.$$.fragment),i=j(),J(o.$$.fragment),s=j(),u=M("div"),l=M("div"),l.innerHTML='<span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span>',a=j(),c=M("div"),c.innerHTML='<span class="prompt-instruction-command">\u21B5</span><span>to open</span>',f=j(),p=M("div"),d=M("span"),d.textContent="esc",m=j(),_.c(),k(e,"class","modal-title"),k(l,"class","prompt-instruction"),k(c,"class","prompt-instruction"),k(d,"class","prompt-instruction-command"),k(p,"class","prompt-instruction"),k(u,"class","prompt-instructions")},m(g,b){w(g,e,b),w(g,n,b),Q(r,g,b),w(g,i,b),Q(o,g,b),w(g,s,b),w(g,u,b),G(u,l),G(u,a),G(u,c),G(u,f),G(u,p),G(p,d),G(p,m),_.m(p,null),y=!0},p(g,[b]){let x={};b&1&&(x.value=g[0]),r.$set(x);let A={};b&65564&&(A.$$scope={dirty:b,ctx:g}),o.$set(A),v!==(v=h(g,b))&&(_.d(1),_=v(g),_&&(_.c(),_.m(p,null)))},i(g){y||(D(r.$$.fragment,g),D(o.$$.fragment,g),y=!0)},o(g){$(r.$$.fragment,g),$(o.$$.fragment,g),y=!1},d(g){g&&F(e),g&&F(n),H(r,g),g&&F(i),H(o,g),g&&F(s),g&&F(u),_.d()}}}var mt="";function _r(t,e,n){let r=t.find(i=>i.offset>e);return r?t.filter(i=>i.offset>e&&i.offset<=r.offset+n):[]}function gr(t,e,n){let{modal:r}=e,{parent:i=null}=e,{singleFilePath:o=""}=e,{searchQuery:s}=e,u=[],l=0,a=null;ie(()=>{mt&&!s&&n(0,s=mt),O.disable("vault"),O.on("infile","enter",d),O.on("infile","arrow-up",()=>f(-1)),O.on("infile","arrow-down",()=>f(1))}),at(()=>{O.enable("vault")});function c(h){let v=[],_=-1;for(;;){let g=_r(h,_,Ee);if(!g.length)break;_=g.last().offset,v.push(g)}return v}function f(h){n(4,l=Ce(l+h,u.length)),p()}async function p(){await oe(),document.querySelector(`[data-result-id="${l}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}async function d(){if(a){r.close(),i&&i.close(),await app.workspace.openLinkText(a.path,"");let h=app.workspace.getActiveViewOfType(hn.MarkdownView);if(!h)throw new Error("OmniSearch - No active MarkdownView");let v=u[l]??0,_=h.editor.offsetToPos(v);_.ch=0,h.editor.setCursor(_),h.editor.scrollIntoView({from:{line:_.line-10,ch:0},to:{line:_.line+10,ch:0}})}}let m=h=>n(0,s=h.detail),y=(h,v)=>n(4,l=h);return t.$$set=h=>{"modal"in h&&n(6,r=h.modal),"parent"in h&&n(1,i=h.parent),"singleFilePath"in h&&n(7,o=h.singleFilePath),"searchQuery"in h&&n(0,s=h.searchQuery)},t.$$.update=()=>{if(t.$$.dirty&129){e:s&&(n(2,a=Me(s,{singleFilePath:o})[0]??null),mt=s),n(4,l=0),p()}if(t.$$.dirty&4){e:if(a){let h=c(a.matches);n(3,u=h.map(v=>Math.round((v.first().offset+v.last().offset)/2)))}}},[s,i,a,u,l,d,r,o,m,y]}var vn=class extends V{constructor(e){super();U(this,e,gr,vr,W,{modal:6,parent:1,singleFilePath:7,searchQuery:0})}},_n=vn;var vt=class extends gn.Modal{constructor(e){super(e);let n=this.containerEl.find(".modal-close-button");this.modalEl.replaceChildren(),this.modalEl.append(n),this.modalEl.addClass("omnisearch-modal","prompt"),this.modalEl.removeClass("modal"),this.modalEl.tabIndex=-1,this.scope.register([],"ArrowDown",()=>{O.emit("arrow-down")}),this.scope.register([],"ArrowUp",()=>{O.emit("arrow-up")}),this.scope.register(["Ctrl"],"Enter",()=>{O.emit("ctrl-enter")}),this.scope.register(["Meta"],"Enter",()=>{O.emit("ctrl-enter")}),this.scope.register(["Alt"],"Enter",()=>{O.emit("alt-enter")}),this.scope.register(["Shift"],"Enter",()=>{O.emit("shift-enter")}),this.scope.register([],"Enter",()=>{O.emit("enter")})}},_t=class extends vt{constructor(e){super(e);let n=new cn({target:this.modalEl,props:{modal:this}});this.onClose=()=>{n.$destroy()}}},we=class extends vt{constructor(e,n,r="",i){super(e);let o=new _n({target:this.modalEl,props:{modal:this,singleFilePath:n.path,parent:i,searchQuery:r}});i&&i.containerEl.toggleVisibility(!1),this.onClose=()=>{i&&i.containerEl.toggleVisibility(!0),o.$destroy()}}};var gt=class extends He.Plugin{async onload(){this.addCommand({id:"show-modal",name:"Vault search",callback:()=>{new _t(app).open()}}),this.addCommand({id:"show-modal-infile",name:"In-file search",editorCallback:(e,n)=>{new we(app,n.file).open()}}),app.workspace.onLayoutReady(async()=>{this.registerEvent(this.app.vault.on("create",e=>{pe(e)})),this.registerEvent(this.app.vault.on("delete",e=>{nt(e)})),this.registerEvent(this.app.vault.on("modify",async e=>{nt(e),await pe(e)})),this.registerEvent(this.app.vault.on("rename",async(e,n)=>{e instanceof He.TFile&&e.path.endsWith(".md")&&(rt(n),await pe(e))})),await jt()})}};
